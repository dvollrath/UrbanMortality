%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Try to match European historical situation with slow UMT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function mchistory(fitted,Setup)

    f = fopen('../Drafts/table_jv_history.tex','w');

    fprintf(f,'1. \\emph{Observed data:} & 12.5 & 50.0 & 1.0 & 40.0 & 30.0 & 7.0 & 50.0 & 20.0 & 12.9 \\\\ \n');

    % Reset to European starting conditions and demographics
    Alt = Setup;
    Alt.Size = [.0625; .0625; .875];
    Alt.CBR = [.0325; .0375; .040];
    Alt.CBRMin = [.03; .03; 0.035];
    Alt.PreCDR = [.0325; .0425; .025];
    Alt.PostCDR = [.020; .030; .020];
    Alt.UMT = [.41; 50; 0]; % longer mortality transition
    time = 150;
    R = mcfix(time,fitted,Alt);
    
    fprintf(f,'2. Calibrated model, exog. fert. & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});

    Alt.UMT = [.41; 3; 0]; % shorter mortality transition
    R = mcfix(time,fitted,Alt);
    fprintf(f,'3. Calibrated model, exog. fert., fast UMT & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});
    
    Alt.PostCDR = [.015; .015; .020];
    R = mcfix(time,fitted,Alt);
    fprintf(f,'4. Calibrated model, exog. fert., fast UMT, large UMT & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});
    
    Alt.Fertility = [-.3; -.3; 1]; % use endogenous fert responses
    Alt.Tau = [0; 0; 0]; % no change in CBR over time
    Alt.PostCDR = [.020; .030; .020];
    Alt.UMT = [.41; 50; 0]; % longer mortality transition
    R = mcfix(time,fitted,Alt);
    
    fprintf(f,'5. Calibrated model, endog. fert. & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});

    Alt.UMT = [.41; 3; 0]; % shorter mortality transition
    R = mcfix(time,fitted,Alt);
    fprintf(f,'6. Calibrated model, endog. fert., fast UMT & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});

    Alt.PostCDR = [.015; .015; .020];
    R = mcfix(time,fitted,Alt);
        fprintf(f,'7. Calibrated model, endog. fert., fast UMT, large UMT & %9.1f & %9.1f & 1.0 & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f & %9.1f \\\\ \n', ...
        100*(Alt{'Formal','Size'} + Alt{'Informal','Size'})/sum(Alt{:,'Size'}), ...
        100*(Alt{'Informal','Size'}/(Alt{'Formal','Size'} + Alt{'Informal','Size'})), ...
        100*R{100,'UrbPerc'},100*R{100,'InfUrbPerc'},R{100,'RelUrbSize'}, ...
        100*R{140,'UrbPerc'},100*R{140,'InfUrbPerc'},R{140,'RelUrbSize'});

    fclose(f); 
end
